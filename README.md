# PolarUnwrap
Script for analyzing radially symmetric confocal images
Documentation for polar unwrap quantification

Each image (Fig 1, raw) is annotated by marking the center of the root and following the most recent cell division on each cell column in the cambium (Fig1, annotated) and rotated that the primary xylem row is oriented in vertical position (see tutorial section with FIJI). Marked line should be continuous, but interpolation or filling with average or median in non-continous line is possible. Also only partial images can be aligned if the center point is marked accordingly.


Fig 1

Image is padded to a square enveloping the whole image and adding empty pixels (with value -1 to distinguish from original pixels) around the image so that the root center was the middle of the newly generated square image (Fig 1, centered). In this example case the original image size is 10242 and centered is 11172 (+/-1 pixel per side). 
Center point is defined as the smallest contour area using OpenCV-python library and removed. Only the region of interest (ROI) is saved from the annotation channel (green). From the annotated center point image is sampled phi (480) times by drawing a line from defined center and sampling at an angle of (phi/360) * i/phi. Lower case i is representing an iterative index. Each sampling angle is taken r times r being the square edge length divided by two (1117/2). Each angle is collected to a new array shaped (phi*r) to create a polar projection from the designated center point (Fig 1, polar projection).


Fig 2

Each column is aligned to the median position of the annotated value 255 representing the center point of the marked cambium (Fig 2) aligning the cambium as a straight line. This way the signal position in relation to the most recent cell division can be compared between images. The aligned array must be resized in y-axis to accommodate the largest and smallest gap between the xylem (center).

For comparing multiple images the same procedure is repeated to each image and the resulting polar projections can be aligned using the ROI (cambium line). After the alignment between images the position and intensity of the signal can be compared between different treatments. To generate an average intensity image of the signal each x and y coordinate position is averaged between the aligned images (Fig 3)


Fig 3

All averaged signals can again be aligned by ROI and saved as a composite image that can be assembled as one with annotations and titles dynamically generated by the file directories. All images are finally save with annotation and are stitched to a single image all average projections side by side. Image can be mapped with XPP and PP markings that represent sectors in the root (Fig 4)


Fig 4

Final image contains Also average x and y signals as heat maps 






Materials and methods
Each image was annotated by marking the center of the root and following the most recent cell division on each cell column in the cambium and rotated so that the primary xylem row is oriented in vertical position. Signal data from the image was sampled from the center point to the edges of the root and aligned to the most recent cell division in the cambial zone. All images in the same treatment were then aligned with the annotated cambial line starting from the center to the edge. Each treatment can be intercompared and analyzed by the fluorescent signal distribution and intensity and by the location/distance of cambium from the root center.
The image wrapping was done using Python 3.8.10 and image ROI area extraction was done using several different libraries including OpenCV2 ((Bradski 2000; Harris et al. 2020; Droettboom et al.; Clark 2015; Rossum, Drake & Jr). More detailed documentation in github


References

Bradski, G 2000, 'The OpenCV Library. Software to achive machine vision tasks', Dr. Dobb's Journal of Software Tools



Clark, A 2015, 'Python Imaging Library is a free library for the Python programming language', Pillow (PIL Fork) Documentation. readthedocs



Droettboom, M, Caswell, T, Hunter, J, Firing, E, Nielsen, J, Lee, A, Andrade, E, Varoquaux, N, Stansby, D & Root, B 'matplotlib/matplotlib v2.2.1', 



Harris, CR, Millman, KJ, van der Walt, SJ, Gommers, R, Virtanen, P, Cournapeau, D, Wieser, E, Taylor, J, Berg, S, Smith, NJ, Kern, R, Picus, M, Hoyer, S, van Kerkwijk, MH, Brett, M, Haldane, A, Del Río, JF, Wiebe, M, Peterson, P, Gérard-Marchant, P, Sheppard, K, Reddy, T, Weckesser, W, Abbasi, H, Gohlke, C & Oliphant, TE 2020, 'Array programming with NumPy', Nature, vol. 585, no. 7825, pp. 357-362.



Rossum, GV, Drake, FL & Jr 'Python 3 Reference Manual: (Python Documentation Manual Part 2)', 



